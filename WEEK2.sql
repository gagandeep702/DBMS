 CREATE DATABASE 1BM21CS064_INSURANCE;
 USE  1BM21CS064_INSURANCE;
CREATE TABLE 1BM21CS064_INSURANCE.PERSON(
DRIVER_ID VARCHAR(10),
NAME VARCHAR(20),
ADRESS VARCHAR(20),
PRIMARY KEY(DRIVER_ID));

CREATE TABLE 1BM21CS064_INSURANCE.CAR(
REG_NUM VARCHAR(10),
MODEL VARCHAR(20),
YEAR INT,
primary key(REG_NUM)
);
CREATE TABLE 1BM21CS064_INSURANCE.OWNS(
DRIVER_ID VARCHAR(10),
REG_NUM VARCHAR(10),
primary key(DRIVER_ID,REG_NUM),
foreign key(DRIVER_ID) references 1bm21cs064_insurance.person(DRIVER_ID),
foreign key(REG_NUM) REFERENCES 1bm21cs064_insurance.car(REG_NUM)
);

CREATE TABLE 1BM21CS064_INSURANCE.ACCIDENT1(
REPORT_NUM INT,
ACCIDENT_DATE date,
LOCATION varchar(100),
primary key(REPORT_NUM)
);

CREATE TABLE 1BM21CS064_INSURANCE.PARICIPATED1(
DRIVER_ID VARCHAR(10),
REG_NUM VARCHAR(10),
REPORT_NUM INT,
DAMAGE_AMOUNT INT,
primary key(DRIVER_ID,REG_NUM,REPORT_NUM),
foreign key(DRIVER_ID) references PERSON(DRIVER_ID),
foreign key(REG_NUM) REFERENCES CAR(REG_NUM),
foreign key(REPORT_NUM) references ACCIDENT1(REPORT_NUM)
);
INSERT INTO 1BM21CS064_INSURANCE.ACCIDENT1 VALUES(11,'2003-01-01','Mysore Road');
INSERT INTO 1BM21CS064_INSURANCE.ACCIDENT1 VALUES(12,'2004-02-02','South end circle');
INSERT INTO 1BM21CS064_INSURANCE.ACCIDENT1 VALUES(13,'2003-01-21','Bull temple Road');
INSERT INTO 1BM21CS064_INSURANCE.ACCIDENT1 VALUES(14,'2008-02-17','Mysore Road');
INSERT INTO 1BM21CS064_INSURANCE.ACCIDENT1 VALUES(15,'2004-03-05','Kanakpur Road');
INSERT INTO 1BM21CS064_INSURANCE.PERSON VALUES('A01','Richard','Srinivas nagar');
INSERT INTO 1BM21CS064_INSURANCE.PERSON VALUES('A02','Pradeep','Rajiji nagar');
INSERT INTO 1BM21CS064_INSURANCE.PERSON VALUES('A03','Smith','Ashok nagar');
INSERT INTO 1BM21CS064_INSURANCE.PERSON VALUES('A04','Venu','N R colony');
INSERT INTO 1BM21CS064_INSURANCE.PERSON VALUES('A05','Jhon','Hanumanthnagar');
INSERT INTO 1BM21CS064_INSURANCE.CAR VALUES('KA052205','Indica',1990);
INSERT INTO 1BM21CS064_INSURANCE.CAR VALUES('KA031181','Lancer',1957);
INSERT INTO 1BM21CS064_INSURANCE.CAR VALUES('KA095477','Toyota',1998);
INSERT INTO 1BM21CS064_INSURANCE.CAR VALUES('KA053408','Honda',2008);
INSERT INTO 1BM21CS064_INSURANCE.CAR VALUES('KA041702','Audi',2005);
INSERT INTO  1BM21CS064_INSURANCE.PARICIPATED1 VALUES('A01','KA052205',11,10000);
INSERT INTO  1BM21CS064_INSURANCE.PARICIPATED1 VALUES('A02','KA053408',12,50000);
INSERT INTO  1BM21CS064_INSURANCE.PARICIPATED1 VALUES('A03','KA095477',13,25000);
INSERT INTO  1BM21CS064_INSURANCE.PARICIPATED1 VALUES('A04','KA031181',14,3000);
INSERT INTO  1BM21CS064_INSURANCE.PARICIPATED1 VALUES('A05','KA041702',15,5000);
INSERT INTO 1BM21CS064_INSURANCE.OWNS VALUES('A01','KA052205');
INSERT INTO 1BM21CS064_INSURANCE.OWNS VALUES('A02','KA053408');
INSERT INTO 1BM21CS064_INSURANCE.OWNS VALUES('A03','KA095477');
INSERT INTO 1BM21CS064_INSURANCE.OWNS VALUES('A04','KA031181');
INSERT INTO 1BM21CS064_INSURANCE.OWNS VALUES('A05','KA041702');
select * FROM  1BM21CS064_INSURANCE.PERSON;
select * FROM 1BM21CS064_INSURANCE.CAR;
select * FROM 1BM21CS064_INSURANCE.OWNS;
select * FROM 1BM21CS064_INSURANCE.ACCIDENT1;
select * FROM 1BM21CS064_INSURANCE.PARICIPATED1;
UPDATE 1BM21CS064_INSURANCE.PARICIPATED1 set damage_amount=25000
where reg_num='KA053408' AND report_num=12;
select count(distinct driver_id) CNT
FROM 1BM21CS064_INSURANCE.PARICIPATED1 a,1BM21CS064_INSURANCE.ACCIDENT1 b
where a.report_num and b.accident_date like '2008%';
insert into 1BM21CS064_INSURANCE.ACCIDENT1 values(16,'2008-03-08','domlur');
SELECT * FROM 1BM21CS064_INSURANCE.ACCIDENT1;
SELECT ACCIDENT_DATE,LOCATION FROM 1BM21CS064_INSURANCE.ACCIDENT1;
select DRIVER_ID FROM 1BM21CS064_INSURANCE.PARICIPATED1
WHERE DAMAGE_AMOUNT>=25000; 
SELECT * FROM 1BM21CS064_INSURANCE.PARICIPATED1 ORDER BY DAMAGE_AMOUNT DESC;
SELECT AVG(DAMAGE_AMOUNT) FROM 1BM21CS064_INSURANCE.PARICIPATED1;
DELETE FROM PARICIPATED1
WHERE DAMAGE_AMOUNT <(SELECT T.AVG1 FROM (SELECT AVG(DAMAGE_AMOUNT) AS AVG1 FROM PARICIPATED1) T);
SELECT NAME FROM PERSON A , PARICIPATED1 B 
WHERE A.DRIVER_ID=B.DRIVER_ID 
AND DAMAGE_AMOUNT>(SELECT AVG(DAMAGE_AMOUNT) FROM PARICIPATED1);
SELECT MAX(DAMAGE_AMOUNT) FROM 1BM21CS064_INSURANCE.PARICIPATED1;
SELECT * FROM CAR ORDER BY YEAR ASC;
SELECT COUNT(REPORT_NUM)
FROM CAR C,PARICIPATED1 P
WHERE C.REG_NUM=P.REG_NUM AND C.MODEL='LANCER';
SELECT COUNT(DISTINCT DRIVER_ID) CNT
FROM paricipated1 A, ACCIDENT1 B
WHERE A.REPORT_NUM =B.REPORT_NUM AND B.ACCIDENT_DATE LIKE '__08%';








 